def hasNumber(string):
  return any(char.isdigit() for char in string)  

def hasPortfolio(str):
  all_portfolios = ['test 2','test 3','50% risk portfolio']
  for port in all_portfolios:
    if port in str:
      return port
      
def findCompany(str):
  import re
  string = str.lower()
  string = re.sub(r'[^\w\s]','',string)
  string = ''.join([i for i in string if not i.isdigit()])  
  string = string.split()
  bank = ['?','my','how','are','you','see','can','i','whatsup','with','did','anything','is','there','should','know','to','the','what','much','will','profit','be','future','projected','budget','backtest','portfolio','unrealized','gains','buy','perform','performing','top','today','stock','stocks','about','a','into','for','who','whats','share','of','in','ceo','store','analyst','revenue','volume','day','hi','doing',"what's",'symbol','losses','dividend','company','name','ndx','dji','dow jones','nasdaq','sp','sp500','market','rating','analyst','analyze','revenue','year','compare','does','in','price','against','margin']
  for word in bank:
    try:
      string.remove(word)
    except ValueError:
      continue
  return(string)

def analyze(messages):
  message = messages.lower()
  if "my portfolios" in message:
    if "sp500" in messages or "s&p" in message:
      return("compare sp to my port")
    elif "nasdaq" in messages or "ndx" in message:
      return("compare ndx to my port")
    elif "dow" in messages or "dji" in message or "dow jones" in message:
      return("compare dji to my port")
    else:
      return("get status of ports")
  if "compare" in message:
    if "s&p500" in message or "s&p" in message:
      if (hasPortfolio(message)):
        return("your portfolio <" + hasPortfolio(message) + "> compares well")      
      else:
        try:
          return("compare " + findCompany(message)[0] + " to my the s&p")
        except IndexError:
          return("Sorry, I didn't recognize that request. I've told my creator about this and he will be working on it!")
    elif "nasdaq" in messages or "ndx" in messages:
      if (hasPortfolio(message)):
        return("your portfolio <" + hasPortfolio(message) + "> compares well")      
      else:     
        try:
          return("compare " + findCompany(message)[0] + " to my the ndx")
        except IndexError:
          return("Sorry, I didn't recognize that request. I've told my creator about this and he will be working on it!")
    elif "dow" in messages or "dji" in messages or "dow jones" in messages:
      if (hasPortfolio(message)):
        return("your portfolio <" + hasPortfolio(message) + "> compares well")      
      else:     
        try:
          return("compare " + findCompany(message)[0] + " to my the dji")
        except IndexError:
          return("Sorry, I didn't recognize that request. I've told my creator about this and he will be working on it!")
    else:
      return("get status of ports")
  elif "buy" in messages and "for" in messages:
    try:
      return("you bought <" + findCompany(message)[0] + "> for 3$")
    except IndexError:
      return("Sorry, I didn't recognize that request. I've told my creator about this and he will be working on it!")
  elif "top" in message or "highest performing" in message:
    return("the top stocks today are my d !")
  elif "lowest" in message or "worst" in message: 
    return("the lowest stocks today are my d !")
  elif "how" in messages and "performing" in message:
    if (hasPortfolio(message)):
      return("your portfolio <" + hasPortfolio(message) + "> is doing well!")
    elif (findCompany(message)):
      try:
        return("your stock <" + findCompany(message)[0] + "> is doing quite well")
      except IndexError:
        return("Sorry, I didn't recognize that request. I've told my creator about this and he will be working on it!")
  elif "how" in messages and "doing" in message:
    if (hasPortfolio(message)):
      return("your portfolio <" + hasPortfolio(message) + "> is doing well!")
    elif (findCompany(message)):
      try:
        return("your stock <" + findCompany(message)[0] + "> is doing quite well")
      except IndexError:
        return("Sorry, I didn't recognize that request. I've told my creator about this and he will be working on it!")       
  elif "symbol for" in messages or "symbol of" in messages:
    if (findCompany(message)):
      return("the symbol for <" + findCompany(message)[0] + "> is google !")
  elif "company name of" in messages or "company name for" in messages or "what company is" in messages:
    if (findCompany(message)):
      return("the company name for <" + findCompany(message)[0] + "> is google !")
  elif "ceo of" in messages or "ceo for" in messages:
    if (findCompany(message)):
      return("the ceo of <" + findCompany(message)[0] + "> is tim cook !")
  elif "dividends" in messages and "does" in messages:
    if (findCompany(message)):
      return("the company <" + findCompany(message)[0] + "> does pay dividends!")
  elif "what" in messages and "price" in messages:
    if (findCompany(message)):
      return("the market price for the company <" + findCompany(message)[0] + "> is 2!")
  elif "gain" in messages:
    if hasPortfolio(message):
      return("your gains for <" + hasPortfolio(message) + "> is 3$!")
    elif findCompany(message):
      try:
        return("your gains for <" +  findCompany(message)[0] + "> is 3$")
      except IndexError:
        return("Sorry, I didn't recognize that request. I've told my creator about this and he will be working on it!")
  elif "losses" in messages:
    if hasPortfolio(message):
      return("your losses for <" + hasPortfolio(message) + "> is 3$!")
    elif findCompany(message):
      try:
        return("your losses for <" +  findCompany(message)[0] + "> is 3$")
      except IndexError:
        return("Sorry, I didn't recognize that request. I've told my creator about this and he will be working on it!")
  elif "rating" in messages:
    if (findCompany(message)):
      return("the rating for the company <" + findCompany(message)[0] + "> by analysts are high!")
  elif "pe ratio" in messages:
    if (findCompany(message)):
      return("the PE ratio for the company <" + findCompany(message)[0] + "> by analysts are high!")
  elif "beta" in messages:
    if (findCompany(message)):
      return("the beta for the company <" + findCompany(message)[0] + "> by analysts are high!")
  else:
    return("Sorry, I didn't recognize that request. I've told my creator about this and he will be working on it!")

      

print(analyze("what is my highest performing stock?"))

#     elif "nasdaq" in messages or "ndx" in messages:
#     elif "dow" in messages or "dji" in messages or "dow jones" in messages:
  #elif "buy" in messages and "for" in messages:
#   elif "top" in messages or "highest performing" in messages:

#   elif "future" in messages:
#   elif "back test" in messages or "back-test" in messages or "backtesting" in messages:

#   elif "symbol for" in messages or "symbol of" in messages:
#   elif "company name of" in messages or "company name for" in messages or "what company is" in messages:
#   elif "ceo of" in messages or "ceo for" in messages:

#   elif "dividends" in messages and "does" in messages:
#   elif "gain" in messages:
#   elif "losses" in messages:
  #elif "rating" in messages and "analyst" in messages:
#   elif "pe ratio" in messages:
#   elif "beta" in messages:

    

# print(findOperatingNouns("whats the 60 day profit margin for valspar?"))



  <div class="row" style="margin:0px">
    <div class="col-lg-2 col-md-2" style="height:600px;padding-left:0px;padding-right:0px;margin-right:10px">
        <div class="block" style="height:599px;margin:0px">
            <div class="header">
                <h2 style="font-size:12px;font-weight:100;font-family:'helvetica neue">Your Portfolios</h2>
            </div>
            <div class="content list-group ui-sortable" id="sortable_example_1" style="height:559px;background:rgba(0,0,0,0.5);overflow:hidden">
                {% for portfolio in portfolios %}
                <a href="#" class="list-group-item" style="text-align:center;height:150px">{{portfolio.name}}
                  <br>
                  <span style="font-size:18px;font-weight:100;font-family:'Helvetica Neue';top:7px;left:7px;position:relative">
                    ${{portfolio.value}}
                  </span><br><br>
                 <span style="font-size:14px;font-weight:100;font-family:'Helvetica Neue';position:relative;bottom:7px;color:#00ff00">
                      +33%
                  </span><br>
                 <span style="font-size:14px;font-weight:100;font-family:'Helvetica Neue'">
                    {{portfolio.no_of_tickers}} Tickers
                  </span>                
                </a>
                {% endfor %}
            </div>
        </div> 
      </div>
    <div class="col-lg-7 col-md-5" style="width:61%;margin-left:1vw;margin-right:1vw;padding:0px;height:605px;overflow:hidden;font-weight:100;font-family:'Helvetica Neue';letter-spacing:2px;">
        <div class="block" style="margin-left:-5px;margin-bottom:10px;height:240px;">
            <div class="header">
                <h2 style="font-size:12px;letter-spacing:2px;padding-left:2px"> Performance Summary </h2>
                  <div class="btn-group pull-right">
                    <button type="button" class="btn btn-default btn-clean dropdown-toggle" data-toggle="dropdown" aria-expanded="false" style="letter-spacing:2px">
                    Select Analytic <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" role="menu">
                        <li><a href="#">Portfolio Summary</a></li>
                        <li><a href="#">Compare to S&P 500</a></li>
                        <li><a href="#">Compare to NDX</a></li>
                        <li><a href="#">Compare to DJI</a></li>
                        <li><a href="#">Back-Test</a></li>
                      <li class="divider"></li>                        
                        <li><a href="#">Your Stocks</a></li>

          <!--       {% for portfolio in portfolios %}                      
                        <li><a href="#">{{portfolio.name}}</a></li>
                {% endfor %} -->
                    </ul>
                 </div>
            </div>
            <div class="block content" style="background:rgba(0,0,0,0.6);height:200px;margin-bottom:0px">
              <label style="font-weight:100;font-family:'helvetica neue'">Unrealized Gains</label>    <br>           
                  <div class="knob" style="margin:10px">
                      <div style="display: block; width: 100px; height: 100px;">
                        <canvas width="100" height="100" style="position: absolute !important; top:-100px !important"></canvas>
                        <input type="text" data-fgcolor="#FFFFFF" data-min="0" data-max="100" data-width="100" data-height="100" value="99" style="width: 50px; height: 33px; position: absolute; vertical-align: middle; top: 0px; left: 50%; margin-top: -16px; margin-left: -25px; border: 0px; background: none; font-style: normal; font-variant: normal; font-weight: bold; font-stretch: normal; font-size: 20px; line-height: normal; font-family: Arial; text-align: center; color: rgb(255, 255, 255); padding: 0px; -webkit-appearance: none;"></div>
                  </div>

            </div>
        </div>  
      <div class="block" style="margin-left:-5px;margin-bottom:20px;margin-top:8px;height:340px">
          <div class="header">
                <h2 style="font-size:12px">Market Charts</h2> 
                <div class="side pull-right">
                   <div class="btn-group btn-group-xs">
                        <button type="button" class="btn btn-default btn-clean" onClick="changeTime('1y')">1y</button>
                        <button type="button" class="btn btn-default btn-clean" onClick="changeTime('90d')">90d</button>
                        <button type="button" class="btn btn-default btn-clean" onClick="changeTime('30d')">30d</button>                                    
                    </div>  
                </div>
            </div>
            <div class="content bg-dot30" style="height:300px;background:rgba(0,0,0,0.6)">
                  <br><span id="chosenMarket" style="top:-10px;left:85px;position:relative"> 
                    S&P 500
                  </span>

                  <div class="ibox-content" id="myBar" style="height:150px;position:relative;top:-2vh;left:1vw">
                      <div class="row" style="overflow:hidden">
                      </div>
                  </div> 
                  <div class="head-panel nm" style="position:absolute;top:310px;left:25px">
                      <div class="btn-toolbar">
                          <div id="new_input">
                           <div class="btn-group btn-group-xs">
                              <button type="button"  name="stock A" id="stock" value="^GSPC" class="btn btn-default btn-clean" onClick="updateData('^GSPC')">S&P500</button>
                             <button type="button"  name="stock" id="stock" value="^IXIC" class="btn btn-default btn-clean" onClick="updateData('^IXIC')">Nasdaq</button>
                             <button type="button"  name="stock" id="stock" value="^DJI" class="btn btn-default btn-clean" onClick="updateData('^DJI')">Dow Jones</button>

                              <!-- <button type="button" class="btn btn-default btn-clean">Nasdaq</button> -->
                              <!-- <button type="button" class="btn btn-default btn-clean">Dow Jones</button>                                     -->
                          </div>
                        
                          </div>
                      </div>
                 </div>                   
             </div>   
        </div>          
  </div>
    <div class="col-lg-2 col-md-2" style="padding-left:0px;padding-right:0px;font-weight:100;font-family:'Helvetica Neue';letter-spacing:2px;height:600px;margin-left:2.5px">
        <div class="block" style="margin:0px;height:599px">
            <div class="header">
                <h2 style="font-size:12px;letter-spacing:0.25px">Market Headlines</h2>
            </div>
            <div class="content bg-dot30" style="height:560px;overflow:hidden;background:rgba(0,0,0,0.6)">
                <div class="head-panel nm">
                    <div class="col-lg-12" style="height:560px;overflow:scroll">   
                        <table class="table table-hover margin bottom">
                            <tbody id="newsPin">
                                <tr id="incomingNews" style="display:none">
                                    <td><a href="#" target="_blank" style="width:100%;display:inline-block;color:#428bca;text-decoration: underline;"></a></td> 
                                </tr> 
                                </tbody>
                            </table>
                        </div>
                </div>                      
        </div>    
    </div>
        </div> 
      </div>